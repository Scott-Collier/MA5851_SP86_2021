Update comments
Re-organise the order of the functions
Improve code flow
